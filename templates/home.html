{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}梦落无声的博客{% endblock %}
{% block header_extends %}
    <link rel="stylesheet" href="{% static 'home.css' %}">
    <script src="//cdn.hcharts.cn/highcharts/highcharts.js"></script>
{% endblock %}
{% block nav_home_active %}active{% endblock %}
{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-sm-4">
                <div class="blog-type">
                    <h3 class="type-title">
                        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                        博客分类
                    </h3>
                    <ul>
                        {% for blog_type in blog_types %}
                            <li>
                                <a href="{% url 'blogs_with_type' blog_type.pk %}">
                                    {{ blog_type.type_name }} ({{ blog_type.blog_count }})
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            <div class="col-sm-4">
                <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
                    <!-- Wrapper for slides -->
                    <div class="carousel-inner" role="listbox">
                        <div class="item active">
                            <img src="/static/images/background.jpg" alt="">
                            <div class="carousel-caption">
                                <h3>公告</h3>
                            </div>
                        </div>
                        {% for field in notice %}
                            <div class="item notice">
                                <img src="/static/images/background.jpg" alt="">
                                <div class="carousel-caption">
                                    <p>{{ field.creat_time|date:"Y-m-d H:i:s" }}</p>
                                    <p>{{ field.content|safe }}</p>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    <!-- Controls -->
                    <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
                        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
                        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
            <div class="col-sm-4" style="min-height: 380px;">
                <div>
                    <ul class="nav nav-tabs" role="tablist">
                        <li role="presentation" class="active">
                            <a href="#datas" aria-controls="datas" role="tab"
                               data-toggle="tab">七日阅读数据
                            </a>
                        </li>
                        <li role="presentation">
                            <a href="#weixin" aria-controls="weixin" role="tab"
                               data-toggle="tab">公众号
                            </a>
                        </li>
                        <li role="presentation">
                            <a href="#hot" aria-controls="hot" role="tab"
                               data-toggle="tab">昨日热门
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="datas">
                            <!-- 图表容器 DOM -->
                            <div id="container"></div>
                            <script>
                                // 图表配置
                                var options = {
                                    chart: {type: 'line'},
                                    title: {text: null},
                                    xAxis: {
                                        categories: {{ dates|safe }},   // x 轴分类
                                        tickmarkPlacement: 'on',
                                        title: {text: '前7日阅读量变化'},
                                    },
                                    yAxis: {
                                        title: {text: null},
                                        labels: {enabled: false},
                                        gridLineDashStyle: 'Dash',
                                    },
                                    series: [{                              // 数据列
                                        name: '阅读量',                     // 数据列名
                                        data: {{ read_nums }}               // 数据
                                    }],
                                    plotOptions: {
                                        line: {
                                            dataLabels: {
                                                enabled: true
                                            }
                                        }
                                    },
                                    legend: {enabled: false},
                                    credits: {enabled: false},
                                };
                                // 图表初始化函数
                                var chart = Highcharts.chart('container', options);
                            </script>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="weixin">
                            <div class="images">
                                <h3>公众号</h3>
                                <img src="/static/images/weixin.jpg" class="img-rounded">
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="hot">
                            <div class="images">
                                <ul>
                                    {% for hot_data in yesterday_hot_data %}
                                        <li>
                                            <a href="{% url 'blog_detail' hot_data.content_object.pk %}">
                                                {{ hot_data.content_object.title }}
                                            </a>
                                        </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <h3>
                <span class="glyphicon glyphicon-fire" aria-hidden="true"></span>热读榜
            </h3>
            <div class="col-sm-4 col-md-4">
                <div class="hot-data">
                    <h3 class="hot-title">日榜</h3>
                    <ul>
                        {% for hot_data in today_hot_data %}
                            <li>
                                <a href="{% url 'blog_detail' hot_data.content_object.pk %}">
                                    {{ hot_data.content_object.title }}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            <div class="col-sm-4 col-md-4">
                <div class="hot-data">
                    <h3 class="hot-title">周榜</h3>
                    <ul>
                        {% for hot_data in hot_blogs_for_7_days %}
                            <li>
                                <a href="{% url 'blog_detail' hot_data.id %}">
                                    {{ hot_data.title }}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            <div class="col-sm-4 col-md-4">
                <div class="hot-data">
                    <h3 class="hot-title">月榜</h3>
                    <ul>
                        {% for hot_blog in hot_blogs_for_30_days %}
                            <li>
                                <a href="{% url 'blog_detail' hot_blog.id %}">
                                    {{ hot_blog.title }}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div style="text-align: center">
        <h5>蜀ICP备18009456号-1</h5>
    </div>
{% endblock %}